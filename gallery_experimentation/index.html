<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Image Gallery</title>
</head>
<body>
    <div id="gallery" class="gallery"></div>
    <div id="overlay" class="overlay">
        <div id="enlarged-image-container">
            <img id="enlarged-image" src="" alt="Enlarged image">
            <div id="image-info">
                <h3 id="image-author"></h3>
                <p id="image-description"></p>
            </div>
        </div>
    </div>
</body>
</html>
<style>
/* ... (previous styles remain the same) ... */

#enlarged-image-container {
    position: relative;
    max-width: 90%;
    max-height: 90%;
}

#enlarged-image {
    display: block;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

#image-info {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px;
    text-align: center;
}

#image-author {
    margin: 0;
    font-size: 1.2em;
}

#image-description {
    margin: 5px 0 0;
    font-size: 1em;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const gallery = document.getElementById('gallery');
    const overlay = document.getElementById('overlay');
    const enlargedImage = document.getElementById('enlarged-image');
    const imageAuthor = document.getElementById('image-author');
    const imageDescription = document.getElementById('image-description');
    const totalImages = 3;
    const targetRowHeight = 200;
    let imageData = {};

    function loadImageData() {
        return fetch('image_data.json')
            .then(response => response.json())
            .then(data => {
                imageData = data;
            })
            .catch(error => console.error('Error loading image data:', error));
    }

    function loadImages() {
        const imagePromises = [];
        for (let i = 1; i <= totalImages; i++) {
            const img = new Image();
            img.src = `images/image${i}.png`;
            const promise = new Promise((resolve, reject) => {
                img.onload = () => resolve(img);
                img.onerror = () => reject(`Failed to load image${i}.png`);
            });
            imagePromises.push(promise);
        }

        Promise.allSettled(imagePromises).then(results => {
            const loadedImages = results
                .filter(result => result.status === 'fulfilled')
                .map(result => result.value);
            displayImages(loadedImages);
        });
    }

    function displayImages(images) {
        gallery.innerHTML = '';
        let row = [];
        let rowWidth = 0;
        const containerWidth = gallery.clientWidth;

        images.forEach((img, index) => {
            const aspectRatio = img.naturalWidth / img.naturalHeight;
            const scaledWidth = targetRowHeight * aspectRatio;
            
            if (rowWidth + scaledWidth > containerWidth) {
                applyRowLayout(row, containerWidth);
                row = [];
                rowWidth = 0;
            }

            row.push({ img, aspectRatio, scaledWidth });
            rowWidth += scaledWidth;

            if (index === images.length - 1) {
                applyRowLayout(row, containerWidth);
            }
        });
    }

    function applyRowLayout(row, containerWidth) {
        const totalAspectRatio = row.reduce((sum, item) => sum + item.aspectRatio, 0);
        const rowHeight = containerWidth / totalAspectRatio;

        row.forEach(({ img, aspectRatio }) => {
            const item = document.createElement('div');
            item.className = 'gallery-item';
            const width = rowHeight * aspectRatio;
            item.style.width = `${width}px`;
            item.style.height = `${rowHeight}px`;
            img.style.width = '100%';
            img.style.height = '100%';
            img.style.objectFit = 'cover';
            item.appendChild(img);
            gallery.appendChild(item);
        });
    }

    function enlargeImage(e) {
        if (e.target.tagName === 'IMG') {
            const imageName = e.target.src.split('/').pop();
            enlargedImage.src = e.target.src;
            
            if (imageData[imageName]) {
                imageAuthor.textContent = imageData[imageName].author;
                imageDescription.textContent = imageData[imageName].description;
            } else {
                imageAuthor.textContent = 'Unknown Author';
                imageDescription.textContent = 'No description available';
            }

            overlay.style.display = 'flex';
        }
    }

    function closeEnlargedImage() {
        overlay.style.display = 'none';
    }

    loadImageData().then(() => {
        loadImages();
        window.addEventListener('resize', () => {
            const images = Array.from(document.querySelectorAll('.gallery-item img'));
            displayImages(images);
        });
        gallery.addEventListener('click', enlargeImage);
        overlay.addEventListener('click', closeEnlargedImage);
    });
});
</script>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
}

.gallery {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    padding: 10px;
    gap: 10px;
}

.gallery img {
    width: 277px;
    height: 277px;
    object-fit: cover;
    border-radius: 10px;
    cursor: pointer;
    transition: transform 0.2s;
}

.gallery img:hover {
    transform: scale(1.05);
}

.overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    justify-content: center;
    align-items: center;
}

.overlay img {
    max-width: 80%;
    max-height: 80%;
    border-radius: 15px;
}

.overlay.active {
    display: flex;
}

.overlay-content {
    text-align: center;
}

#imageInfo {
    color: #fff;
    margin-top: 10px;
}

#authorName {
    font-weight: bold;
    margin-bottom: 5px;
}

</style>